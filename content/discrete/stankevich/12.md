---
title: "ПСП, пути Дика, числа Каталана, разбиения, числа Белла, числа Стирлинга"
index: 12
description: "Лекция 12"
lectureYouTubeLink:
  - "https://www.youtube.com/watch?v=2KQVTmSTncI"
author:
  name: "Худалла А.Б."
  isu: 501855
---

mjx-hidden
$\newcommand{\ihat}{\hat \imath}$
$\newcommand{\jhat}{\hat \jmath}$
$\newcommand{\pipe}{\,|\,}$
$\newcommand{\lra}{\Leftrightarrow}$
$\newcommand{\la}{\Leftarrow}$
$\newcommand{\ra}{\Rightarrow}$
$\newcommand{\mb}{\mathbb}$
$\newcommand{\br}[1]{\{{#1}\}}$
$\newcommand{\ang}[1]{\left \langle{#1}\right\rangle}$
$\newcommand{\ov}{\overline}$
$\newcommand{\argsum}[2]{\underset{#2}{\overset {#1}\sum}}$
$\newcommand{\arghuge}[1]{\huge{#1}\;\normalsize}$
$\newcommand{\tmatrix}[1]{\begin{pmatrix}#1\end{pmatrix}}$
$\newcommand{\bmatrix}[1]{\begin{Bmatrix}#1\end{Bmatrix}}$
$\newcommand{\matal}[1]{\begin{align}#1\end{align}}$
$\newcommand{\pmatrix}[1]{\begin{vmatrix}#1\end{vmatrix}}$
$\newcommand{\system}[1]{\left \{ \begin{align}#1\end{align} \right .}$
$\newcommand{\mc}{\mathcal}$
$\newcommand{\argoplus}[2]{\large \overset{#1}{\underset{#2}\oplus}\normalsize}$
$\newcommand{\arglarge}[3]{\large \overset{#2}{\underset{#3}#1}\normalsize}$
$\newcommand{\mod}[1]{\left | #1 \right |}$

>*Вспомним:*
>Привычные комбинаторные объекты мы умеем считать
>**Перестановки**: $n(n-1)(n-2)...$
>**Сочетания**: $\frac{n(n-1)...(n-k+1)}{k!} = \frac{n!}{(n-k)!k!}$
>**Скобочные последовательности**: $((()))$ и тд

## Рекурентные соотношения и динамическое программирование

### Сочетания (под другим углом)

$\tmatrix{n \\ k} = \tmatrix{n-1 \\ k-1} + \tmatrix{n-1 \\ k}$ - примитивное рекурентное соотношение

### Перестановки

$P_n = P_{n-1} * n$ - тоже рекурентное соотношение

---
### Правильные скобочные последовательности (п.с.п.)

1) $\forall$ префиксы - неотрицательный баланс
2) в конце баланс $0$

![image](/_media/Pasted%20image%2020251129105118.png)

Без требования *1)* - $\tmatrix{2n \\ n}$
Но нам нужно ещё и выполнение условия *2)*

![image](/_media/Pasted%20image%2020251129110659.png)

На базе этого придумаем формулу:

$A_{k,b}$ - количество префиксов п.с.п. длины $k$ с балансом в конце $b$
$C_n = A_{2n,0}$ - количество п.с.п. с $n$ открывающимися скобками

![image](/_media/Pasted%20image%2020251129112208.png)

$\overset {\text{предыдущий элемент -}} {A_{k,b}} = \overset ) {A_{k-1,b+1}}\underbrace{+\overset ( {A_{k-1,b-1}}}_{\text{если}\,b>0}$
$A_{0,0} = 1$
$A_{i,0} = 0 \quad \forall i > 0$

- На первом месте очевидно $($
- На последнем очевидно $)$

![image](/_media/Pasted%20image%2020251129123130.png)

$C_n = \argsum n {i=1} C_{i-1} C_{n-i}$

$C_n = \argsum {n-1} {i=0}C_iC_{n-i-1}$

### $C_n$ - число Каталана

$1,1,2,5,14,42,...$

### Двоичные деревья

![image](/_media/Pasted%20image%2020251129123729.png)

### Разбиения

$n$ шаров
Корзины
$5 = 1+1+1+1+1$
$5 = 5$
$5 = 4+1 \quad (=1+4)$
$5 = 3+2$
$5=3+1+1$
$5=2+2+1$
$5=2+1+1+1$

### Диаграмма Юнга (Ферре)

![image](/_media/Pasted%20image%2020251129124208.png)

### Каноническое представление

Слагаемые представлены по убыванию

$100 = \underset {93} {...\qquad \qquad...}\;|\;\underbrace{2+2+1+1+1}_7$
$p_{n,k}$ - количество разбиений числа $n$ на слогаемые каждые $\leq k$
$P_n = p_{n,n}$

$n = s+ ...$
$s\leq k$
$p_{i,0} = 0 \quad \forall i > 0$
$p_{n,k} = p_{n-k,k} + p_{n,k-1}$
1) $s=k$
2) $s < k$

| ${}_n{}^k$ | 0   | 1   | 2   | 3   | 4   | 5   |
| ---------- | --- | --- | --- | --- | --- | --- |
| 0          | 1   | 1   | 1   | 1   | 1   | 1   |
| 1          | 0   | 1   | 1   | 1   | 1   | 1   |
| 2          | 0   | 1   | 2   | 2   | 2   | 2   |
| 3          | 0   | 1   | 2   | 3   | 3   | 3   |
| 4          | 0   | 1   | 3   | 4   | 5   | 5   |
| 5          | 0   | 1   | 3   | 5   | 6   | 7   |

---

Теперь шары пронумерованы

$n=3$

$123$
$1\quad23$
$2\quad 13$
$3\quad12$
$1\quad 2\quad 3$

### Число Белла $B_n$

$S_2(n,k) \equiv \bmatrix {n \\ k}$
Количество разбиений $n$-элементного множества на $k$ непустых множеств
*Число Стирлинга 2 рода*

$\bmatrix{n \\ k} = \bmatrix{n-1 \\ k-1} + k * \bmatrix {n-1 \\ k}$

$\bmatrix{0 \\ 0} = 1$

| ${}_n{}^k$ | 0   | 1   | 2   | 3   | 4   |
| ---------- | --- | --- | --- | --- | --- |
| 0          | 1   | 0   | 0   | 0   | 0   |
| 1          | 0   | 1   | 0   | 0   | 0   |
| 2          | 0   | 1   | 1   | 0   | 0   |
| 3          | 0   | 1   | 3   | 1   | 0   |
| 4          | 0   | 1   | 7   | 6   | 1   |

### Разбиения на циклы $=$ перестановки $n$ элементов с $k$ циклами

![image](/_media/CleanShot%202025-11-29%20at%2013.02.50@2x.png)

Число Стерлинга первого рода $S_1(n,k) \quad \left [ \matal{n \\ k} \right ]$
$\left [ \matal{n \\ k} \right ] =$
$+\left [ \matal{n-1 \\ k-1} \right ] +$
$+(n-1)\left [ \matal{n-1 \\ k} \right ]$

| ${}_n{}^k$ | 0   | 1   | 2   | 3   | 4   |
| ---------- | --- | --- | --- | --- | --- |
| 0          | 1   | 0   | 0   | 0   | 0   |
| 1          | 0   | 1   | 0   | 0   | 0   |
| 2          | 0   | 1   | 1   | 0   | 0   |
| 3          | 0   | 2   | 3   | 1   | 0   |
| 4          | 0   | 6   | 11  | 6   | 1   |

$n! = \argsum n{k=0}\left [ \matal{n \\ k} \right ]$
