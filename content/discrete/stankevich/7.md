---
title: "Коды, префиксные коды, алгоритм Хаффмана, неравенство Крафта-МакМиллана"
index: 7
description: "Лекция 7"
lectureYouTubeLink:
  - "https://www.youtube.com/watch?v=j1_bAXAWHWM"
author:
  name: "Худалла А.Б."
  isu: 501855
---

mjx-hidden
$\newcommand{\ihat}{\hat \imath}$
$\newcommand{\jhat}{\hat \jmath}$
$\newcommand{\pipe}{\,|\,}$
$\newcommand{\lra}{\Leftrightarrow}$
$\newcommand{\la}{\Leftarrow}$
$\newcommand{\ra}{\Rightarrow}$
$\newcommand{\mb}{\mathbb}$
$\newcommand{\br}[1]{\{{#1}\}}$
$\newcommand{\ang}[1]{\langle{#1}\rangle}$
$\newcommand{\ov}{\overline}$
$\newcommand{\argsum}[2]{\underset{#2}{\overset {#1}\sum}}$
$\newcommand{\arghuge}[1]{\huge{#1}\;\normalsize}$
$\newcommand{\tmatrix}[1]{\begin{pmatrix}#1\end{pmatrix}}$
$\newcommand{\bmatrix}[1]{\begin{Bmatrix}#1\end{Bmatrix}}$
$\newcommand{\matal}[1]{\begin{align}#1\end{align}}$
$\newcommand{\pmatrix}[1]{\begin{vmatrix}#1\end{vmatrix}}$
\$\newcommand\{\system\}\[1\]\{\large\left \\{ \begin\{align\}#1\end\{align\} \right \.\normalsize\}\$
\$\newcommand\{\mc\}\{\mathcal\}\$

---


$\Sigma$ - алфавит (конечное, непустое множество)
$\Sigma^2$ - множество двоек символов, $\Sigma^3$ - троек символов, и т.д. <img src="/_media/Pasted%20image%2020251029000749.png" width="30">
$\Sigma^0 = \br{\epsilon}$

$\underset{k = 0}{\overset{\infty}{\huge \cup}} \normalsize \Sigma^k = \Sigma^*$ - слова над алфавитом $\Sigma$

$\alpha \beta$ - конкатенация: $\Sigma^* \times \Sigma^* \rightarrow \Sigma^*$
$\alpha \in \Sigma^k$
$\beta \in \Sigma^l$
$\gamma = \alpha\beta \in \Sigma^{k+l}$
$\gamma[i] = \bmatrix{\alpha[i], i \leq k \qquad \\ \beta[i-k], i > k}$

1) Операция ассоциативна: $(\alpha\beta)\gamma = \alpha(\beta\gamma)$
2) $\alpha\epsilon = \epsilon \alpha = \alpha$ - нейтральный элемент
$\ra$ Моноид

---

### Код

$\phi: \Sigma^* \rightarrow \Pi^*$

Код однозначный (декодируемый), если:
$\alpha \neq \beta \ra \phi(\alpha) \neq \phi(\beta)$ - то-есть $\phi$ иньективна

ZIP: $\Sigma^* \rightarrow \Sigma^*$
JPEG: $\Sigma^* \rightarrow \Sigma^*$

$def$ Раздельный (Гомоморфный) код $\phi: \Sigma \rightarrow \Pi^*$ (например конвертация "ч" в "ch" в заграннике)

$\phi(c_1c_2c_3 ... c_n) = \phi(c_1)\phi(c_2)...\phi(c_n)$

---

### Теорема

*Не $\exists$ кода $\Sigma^* \rightarrow \Sigma^*$, который не увеличивает $\forall$ текст, а некоторый уменьшает (одноз. декодирование)*

$s$ - строка
$\Sigma = \br{c_1c_2 ... c_k}\quad p_i$ - кол-во вхождений $c_i в s$
$\phi: \Sigma \rightarrow \mb B^* \qquad l_i = len(\phi(c_i))$
$len(\phi(s)) = \argsum{k}{i = 1}l_ip_i \rightarrow min$

#### План капкан:
- Префиксные коды
- Код Хаффмана
- Нер-во Крафта-МакМиллана

##### Префиксный код - однозначно декодируем
>Пример:
>$a = 0$
>$b = 10$
>$c = 11$
>Ни один код не является префиксом другого

Построим дерево для кода из примера:

![image](/_media/Pasted%20image%2020251029003704.png)
Все коды - листья

### Задача: ищем префиксный код, $\Sigma \; l_ip_i \rightarrow min$

##### Лемма 1
В дереве оптимального кода дав символа с $min\;p_i$ являются братьями на максимальной глубине

$Д-во:$
$p_i, p_j$ - минимальные
$p_k, p_l$ - самые глубокие

$\ra p_i \leq p_k \quad l_i \leq l_k$
$\ra p_j \leq p_l \quad l_j \leq l_l$

$\argsum{} t l_t p_t = \argsum{}{t \neq i,j,k,l}l_tp_t+p_il_i+p_jl_j+p_kl_k+p_ll_l$
$\argsum{} t l'_tp_t = \argsum{}{t\neq i,j,k,l} l_tp_i+p_il_k+p_jl_l+p_kl_i+p_ll_j=$
$=p_i(l_i - l_k)+p_j(l_j-l_l) - p_k(l_i - l_k) - p_l(l_j - l_l) = (p_i-p_k)(l_i-l_k)+(p_j - p_l)(l_j-l_l)$

#### Метод Хаффмана

1) Берём два символа которые встречаются минимальное кол-во раз
	Они листья с максимальной глубиной
2) Обьеденим их в один символ $x$
3) Рекурсивно повторяем, достраивая дерево

>Пример:
>![image](/_media/Pasted%20image%2020251029010443.png)

### Теорема (Нер-во Крафта МакМиллана)

$c_1 ... c_k \qquad p_i$ - число вхождений $c_i$
Можно построить однозначно декодируемый двоичный код с длинами $l_i$
$\lra \argsum k {i=1} 2^{-l_i} \leq 1$
